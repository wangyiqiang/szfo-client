<!DOCTYPE html>
<html lang="GBK">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>苏州金融办非法集资举报管理平台</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- DataTables CSS -->
    <link href="../vendor/datatables-plugins/dataTables.bootstrap.css" rel="stylesheet">

    <!-- DataTables Responsive CSS -->
    <link href="../vendor/datatables-responsive/dataTables.responsive.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- szfo CSS -->
    <link href="../dist/css/szfo.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <span class="navbar-brand" >非法集资举报管理平台 v1.0</span>
            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell fa-fw"></i> <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-comment fa-fw"></i>待处理信息
                                    <span class="pull-right text-muted small">4</span>
                                </div>
                            </a>
                        </li>
                    </ul>
                    <!-- /.dropdown-alerts -->
                </li>
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw"></i> <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a href="#"><i class="fa fa-user fa-fw"></i> 用户资料</a>
                        </li>
                        <li class="divider"></li>
                        <li><a href="login.html"><i class="fa fa-sign-out fa-fw"></i> 注销</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <!-- /.dropdown -->
            </ul>
            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <li>
                            <a href="index.html"><i class="fa fa-dashboard fa-fw"></i> 首页</a>
                        </li>
                        <li class="active">
                            <a href="#"><i class="fa fa-table fa-fw"></i> 举报信息管理<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="search.html">举报查询</a>
                                </li>
                                <li>
                                    <a href="#">审核/确认</a>
                                </li>
                                <li>
                                    <a href="morris.html">流转反馈</a>
                                </li>
                            </ul>
                            <!-- /.nav-second-level -->
                        </li>
                        <li>
                            <a href="forms.html"><i class="fa fa-edit fa-fw"></i> 用户管理<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="search1.html">用户编辑</a>
                                </li>
                                <li>
                                    <a href="morris.html">权限配置</a>
                                </li>
                            </ul>
                            <!-- /.nav-second-level -->
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-bar-chart-o fa-fw"></i> 统计分析<span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li>
                                    <a href="flot.html">Flot Charts</a>
                                </li>
                                <li>
                                    <a href="morris.html">Morris.js Charts</a>
                                </li>
                            </ul>
                            <!-- /.nav-second-level -->
                        </li>
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">审核/确认</h1>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row" >
                <div class="col-lg-12" id="table-panel-wrapper">
                    
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs">
                        <li class="active"><a href="#review" data-toggle="tab">待审核举报</a>
                        </li>
                        <li><a href="#confirm" data-toggle="tab">待确认举报</a>
                        </li>
                    </ul>
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div class="tab-pane fade in active" id="review">
                        </br>
                            <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-search">
                                <thead>
                                    <tr>
                                        <th>编号</th>
                                        <th>事项</th>
                                        <th>举报对象</th>
                                        <th>地址</th>
                                        <th>举报人</th>
                                        <th>举报日期</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="tab-pane fade" id="confirm">
                            <h4>Profile Tab</h4>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        </div>
                    </div>
                        
                </div>
                <!-- /.col-lg-12 -->
                <div class="col-lg-12 collapse" id="info-detail"> 
                    <div class="panel panel-info ">
                        <div class="panel-heading">
                            举报详情
                            <span class="fa fa-close fa-pull-right" onclick="closeDetail()"></span>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div>编号：</div>
                            <div>举报人：举报时间：电话：</div>
                            <div>举报对象：事项：地址：</div>
                            <div>案件描述：</div>
                            <div>附件：</div>
                        </div>
                        <!-- /.panel-body -->
                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-wrapper -->
    </div>
    <!-- /#wrapper -->
    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>
    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>
    <!-- DataTables JavaScript -->
    <script src="../vendor/datatables/js/jquery.dataTables.min.js"></script>
    <script src="../vendor/datatables-plugins/dataTables.bootstrap.min.js"></script>
    <script src="../vendor/datatables-plugins/dataTables.chinese.lang.js"></script>
    <script src="../vendor/datatables-responsive/dataTables.responsive.js"></script>
    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <!-- render table -->
    <script>
        $(document).ready(function() {
            var table = $('#dataTables-search').DataTable({
                responsive: true,
                searching: false,
                language: dataTableLangChn(),
                ajax:'/data/data.json',
                columns:[
                    {data:"id"},
                    {data:"type"},
                    {data:"jbdx"},
                    {data:"addr"},
                    {data:"informer"},
                    {data:"date"}
                ]
            });

            $('#dataTables-search tbody').on('dblclick', 'tr', function () {
                var data = table.row( this ).data();
                // alert( 'You clicked on '+data['id']+'\'s row' );
                showDetail(data['id']);
            });
        });

        /**
         * 关闭详情显示区块，并重新展示查询列表
         */
        function closeDetail(){
            $('#info-detail').hide();
            $('#info-detail div.panel-body').html('');
            $('#table-panel-wrapper').show();
        }

        /**
         * 显示详情区块
         * Ajax请求服务端获取举报信息详情JSON
         */
        function showDetail(id){
            $.getJSON('/data/info-detail.json',{"id":id},function(data){
                var attachments = data.attachments;
                var attEl = genAttachEl(attachments);
                var content = `<div class="info-detail-cell"><label>编号：</label> ${data.id}</div>
                            <div class="info-detail-cell"><label>举报人：</label>${data.informer} <label>举报时间：</label>${data.date} <label>电话：${data.phone}</label></div>
                            <div class="info-detail-cell"><label>举报对象</label>${data.jbdx} <label>事项：</label>${data.type} <label>地址：</label>${data.addr}</div>
                            <div class="info-detail-cell"><label>案件描述：</label><p>${data.desc}</p></div>
                            <div class="info-detail-cell"><label>附件：</label>${attEl}</div>`;
                $('#info-detail div.panel-body').html(content);
                $('#info-detail').show();
                $('#table-panel-wrapper').hide();
            });
        }

        /**
         * 生成详情区块附件及图片内容区块HTML
         * 
         * */
        function genAttachEl(attachments){
            if(attachments){
                var attachList = "";
                var picList = "";
                attachments.forEach(url => {
                    var point = url.lastIndexOf("."); 
                    var type = url.substr(point).toLowerCase(); 
                    if(type===".jpg"||type==".gif"||type===".jpeg"||type===".bmp"||type===".npg"){ 
                        picList += "<div class='info-attachment'><a target='_blank' href='"+url+"'><img width=200 height=200 src='"+url+"'></a></div>";
                    }else{
                        point = url.lastIndexOf("/");
                        var fName = "";
                        if(point>0) {
                            fName = url.substr(point+1);
                        }else{
                            fName = url;
                        }
                        attachList += "<li><a target='_blank' href="+url+">附件("+fName+")</a></li>";
                    }
                });
               
                return "<ol>"+picList + attachList+"</ol>";
            }
        }
    </script>
</body>
</html>
